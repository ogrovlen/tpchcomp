Timing is on.
Timing is on.
pg_stat_statements_reset

Time: 0.691 ms
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2482.587 ms (00:02.483)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2105.565 ms (00:02.106)
secs,cov
2.291026395,0.08159970500907295
Time: 0.998 ms
pg_stat_statements_reset

Time: 0.164 ms
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2096.244 ms (00:02.096)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2104.008 ms (00:02.104)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2102.286 ms (00:02.102)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2096.558 ms (00:02.097)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2100.660 ms (00:02.101)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2116.568 ms (00:02.117)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2103.849 ms (00:02.104)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2110.803 ms (00:02.111)
QUERY PLAN
GroupAggregate  (cost=228106.08..228321.02 rows=7816 width=72)
"  Group Key: (substr((customer.c_phone)::text, 1, 2))"
  InitPlan 1 (returns $0)
    ->  Aggregate  (cost=75321.26..75321.27 rows=1 width=32)
          ->  Seq Scan on customer customer_1  (cost=0.00..75202.00 rows=47704 width=6)
"                Filter: ((c_acctbal > 0.00) AND (substr((c_phone)::text, 1, 2) = ANY ('{18,20,33,14,16,28,23}'::text[])))"
  ->  Sort  (cost=152784.81..152804.35 rows=7816 width=38)
"        Sort Key: (substr((customer.c_phone)::text, 1, 2))"
        ->  Nested Loop Anti Join  (cost=0.43..152279.42 rows=7816 width=38)
              ->  Seq Scan on customer  (cost=0.00..75202.00 rows=17500 width=26)
"                    Filter: ((c_acctbal > $0) AND (substr((c_phone)::text, 1, 2) = ANY ('{18,20,33,14,16,28,23}'::text[])))"
              ->  Index Only Scan using orders_o_custkey_idx on orders  (cost=0.43..48.20 rows=18 width=4)
                    Index Cond: (o_custkey = customer.c_custkey)
Time: 0.874 ms
Timing is off.
secs,cov
2.102436231,0.0030709515912586407
