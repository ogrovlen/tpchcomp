Timing is on.
Timing is on.
pg_stat_statements_reset

Time: 0.628 ms
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2480.786 ms (00:02.481)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2098.978 ms (00:02.099)
secs,cov
2.28764695,0.08311547286612565
Time: 1.029 ms
pg_stat_statements_reset

Time: 0.165 ms
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2090.093 ms (00:02.090)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2112.365 ms (00:02.112)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2091.378 ms (00:02.091)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2098.261 ms (00:02.098)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2109.371 ms (00:02.109)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2108.412 ms (00:02.108)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2112.351 ms (00:02.112)
cntrycode,numcust,totacctbal
14,9013,67801655.90
16,8971,67253661.58
18,9210,69312783.61
20,9246,69455185.22
23,8985,67612769.43
28,9027,67660096.94
33,9179,68880125.08
Time: 2107.361 ms (00:02.107)
QUERY PLAN
GroupAggregate  (cost=228106.08..228321.02 rows=7816 width=72)
"  Group Key: (substr((customer.c_phone)::text, 1, 2))"
  InitPlan 1 (returns $0)
    ->  Aggregate  (cost=75321.26..75321.27 rows=1 width=32)
          ->  Seq Scan on customer customer_1  (cost=0.00..75202.00 rows=47704 width=6)
"                Filter: ((c_acctbal > 0.00) AND (substr((c_phone)::text, 1, 2) = ANY ('{18,20,33,14,16,28,23}'::text[])))"
  ->  Sort  (cost=152784.81..152804.35 rows=7816 width=38)
"        Sort Key: (substr((customer.c_phone)::text, 1, 2))"
        ->  Nested Loop Anti Join  (cost=0.43..152279.42 rows=7816 width=38)
              ->  Seq Scan on customer  (cost=0.00..75202.00 rows=17500 width=26)
"                    Filter: ((c_acctbal > $0) AND (substr((c_phone)::text, 1, 2) = ANY ('{18,20,33,14,16,28,23}'::text[])))"
              ->  Index Only Scan using orders_o_custkey_idx on orders  (cost=0.43..48.20 rows=18 width=4)
                    Index Cond: (o_custkey = customer.c_custkey)
Time: 0.879 ms
Timing is off.
secs,cov
2.1022937195,0.004059502325680064
